<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0046)http://www.thinkcart.net/share/lottery-number/ -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>抽奖</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        .scrollPic {
            width: 180px;
            height: 180px;
            overflow: hidden;
            margin: 50px auto;
            float: left;
        }
        .scrollPics {
            width: 100px;
            height: 100px;
            overflow: hidden;
            margin: 80px auto;
            float: left;
        }

        .scrollPic li {
            list-style: none;
            border: 0;
        }
    </style>    
</head>
<body>
<div class="scrollPic aa">
    <ul style="height: 2600px; margin-top: -0px;">
        <li><img src="/images/00.png" width="180" height="180"></li>
        <li><img src="/images/01.png" width="180" height="180"></li>
        <li><img src="/images/02.png" width="180" height="180"></li>
        <li><img src="/images/03.png" width="180" height="180"></li>
        <li><img src="/images/04.png" width="180" height="180"></li>
        <li><img src="/images/05.png" width="180" height="180"></li>
        <li><img src="/images/06.png" width="180" height="180"></li>
        <li><img src="/images/07.png" width="180" height="180"></li>
        <li><img src="/images/08.png" width="180" height="180"></li>
        <li><img src="/images/09.png" width="180" height="180"></li>
    </ul>
</div>
<div class="scrollPics a">
    <ul style="height: 2600px; margin-top: -0px;">
        <li><img src="/images/plus.png" width="100" height="100"></li>
    </ul>
</div>
<div class="scrollPic bb">
    <ul style="height: 2600px; margin-top: -0px;">
        <li><img src="/images/00.png" width="180" height="180"></li>
        <li><img src="/images/01.png" width="180" height="180"></li>
        <li><img src="/images/02.png" width="180" height="180"></li>
        <li><img src="/images/03.png" width="180" height="180"></li>
        <li><img src="/images/04.png" width="180" height="180"></li>
        <li><img src="/images/05.png" width="180" height="180"></li>
        <li><img src="/images/06.png" width="180" height="180"></li>
        <li><img src="/images/07.png" width="180" height="180"></li>
        <li><img src="/images/08.png" width="180" height="180"></li>
        <li><img src="/images/09.png" width="180" height="180"></li>
    </ul>
</div>
<div class="scrollPics a">
    <ul style="height: 2600px; margin-top: -0px;">
        <li><img src="/images/plus.png" width="100" height="100"></li>
    </ul>
</div>
<div class="scrollPic cc">
    <ul style="height: 2600px; margin-top: -0px;">
        <li><img src="/images/00.png" width="180" height="180"></li>
        <li><img src="/images/01.png" width="180" height="180"></li>
        <li><img src="/images/02.png" width="180" height="180"></li>
        <li><img src="/images/03.png" width="180" height="180"></li>
        <li><img src="/images/04.png" width="180" height="180"></li>
        <li><img src="/images/05.png" width="180" height="180"></li>
        <li><img src="/images/06.png" width="180" height="180"></li>
        <li><img src="/images/07.png" width="180" height="180"></li>
        <li><img src="/images/08.png" width="180" height="180"></li>
        <li><img src="/images/09.png" width="180" height="180"></li>
    </ul>
</div>
<div class="scrollPics a">
    <ul style="height: 2600px; margin-top: -0px;">
        <li><img src="/images/equal.png" width="100" height="100"></li>
    </ul>
</div>
<div class="scrollPic dd">
    <ul style="height: 2600px; margin-top: -0px;">
        <li><img src="/images/00.png" width="180" height="180"></li>
        <li><img src="/images/01.png" width="180" height="180"></li>
        <li><img src="/images/02.png" width="180" height="180"></li>
        <li><img src="/images/03.png" width="180" height="180"></li>
        <li><img src="/images/04.png" width="180" height="180"></li>
        <li><img src="/images/05.png" width="180" height="180"></li>
        <li><img src="/images/06.png" width="180" height="180"></li>
        <li><img src="/images/07.png" width="180" height="180"></li>
        <li><img src="/images/08.png" width="180" height="180"></li>
        <li><img src="/images/09.png" width="180" height="180"></li>
    </ul>
</div>
<div class="scrollPic ee">
    <ul style="height: 2600px; margin-top: -0px;">
        <li><img src="/images/00.png" width="180" height="180"></li>
        <li><img src="/images/01.png" width="180" height="180"></li>
        <li><img src="/images/02.png" width="180" height="180"></li>
        <li><img src="/images/03.png" width="180" height="180"></li>
        <li><img src="/images/04.png" width="180" height="180"></li>
        <li><img src="/images/05.png" width="180" height="180"></li>
        <li><img src="/images/06.png" width="180" height="180"></li>
        <li><img src="/images/07.png" width="180" height="180"></li>
        <li><img src="/images/08.png" width="180" height="180"></li>
        <li><img src="/images/09.png" width="180" height="180"></li>
    </ul>
</div>
<div style="margin:0 auto;width:200px;">    
    <input type="button" value="模拟抽奖" onclick="lottery();"  style="width:200px;height: 100px; margin:0 auto;">
    <form action="/api/users/secondGame" method="post">
        <button onclick="secondGame();"  style="width:200px;height: 100px; margin:0 auto;">正式开始</button>
    </form>    
</div>
</body>
<script type="text/javascript" src="/javascripts/jquery.min.js"></script>
    <script type="text/javascript">
        (function ($) {
            $.fn.extend({
                lottery: function (luckyNum,r,options) {
                    var defaults = {
                        'imgWrap': 'ul',
                        'imgBox': 'li'
                    }
                    var options = $.extend(defaults, options);
                    var rand = function (Min, Max) {
                        var Range = Max - Min;
                        var Rand = Math.random();
                        return(Min + Math.round(Rand * Range));
                    }
                    return this.each(function () {
                        var imgBox = $(this).find(options.imgBox);
                        var eachHeight = imgBox.outerHeight();
                        var size = $(this).find(options.imgBox).size();
                        var height = size * eachHeight;
                        var imgWrap = $(this).find(options.imgWrap);
                        imgWrap.height(height);
                        imgWrap.css({'margin-top': 0});
                        var scrollTop = 0;
                        var index = 0;
                        var round = 0;
                        var lucky_num = rand(luckyNum, luckyNum);
                        var run = function () {
                            index++;
                            if (index == 1) round++;
                            if (round == 1) {
                                var speed = 300 - index * 30;
                            } else if (round > 7) {
                                var speed = 300;
                            } else {
                                var speed = 100;
                            }
                            if (round == r && index == (lucky_num + 1)) {
                                //alert(lucky_num);
                            } else if (index == size) {
                                imgWrap.css({'margin-top': 0});
                                index = 0;
                                run();
                            } else {
                                scrollTop = -eachHeight * index;
                                imgWrap.animate({'margin-top': scrollTop}, speed, false, run);
                            }
                        };
                        run();
                    });
                }
            });
        })(jQuery);
        $(function() {
            //定时请求刷新
            setInterval(lottery,60000);
        });
        function lottery() {
            //取出cookie
            var cookie_pos=document.cookie.indexOf('username')+9;
            var cookie_end=document.cookie.indexOf(';', cookie_pos);
            var cookie_username=document.cookie.substring(cookie_pos, cookie_end);
            var cookie_password=document.cookie.indexOf('password')+9;
            $.ajax({
                        url: '/api/business/draw',
                        type: 'post',
                        data:{'username': cookie_username,'password':cookie_password},
                        dataType:"json",
                        success: function (res) {
                            if(res.result=='fail'){
                                alert('登录失败');
                            }else{
                                $('.aa').lottery(res.num1,4);
                                $('.bb').lottery(res.num2,5);
                                $('.cc').lottery(res.num3,6);
                                $('.dd').lottery(res.num4,7);
                                $('.ee').lottery(res.num5,8);
                            }

                        }
                    }
            );
        }

        function secondGame() {
            //取出cookie
            var cookie_pos=document.cookie.indexOf('username')+9;
            var cookie_end=document.cookie.indexOf(';', cookie_pos);
            var cookie_username=document.cookie.substring(cookie_pos, cookie_end);
            var cookie_p=document.cookie.indexOf('password')+9;
            var cookie_password=document.cookie.substring(cookie_p, cookie_p+32);
            $.ajax({
                        url: '/api/users/secondGame',
                        type: 'post',
                        data:{'username': cookie_username,'password':cookie_password},
                        dataType:"json",
                        success: function (res) {
                            if(res.result=='fail'){
                                alert('登录失败'); 
                            }
                        }
                    }
            );
        }
    </script>
</html>